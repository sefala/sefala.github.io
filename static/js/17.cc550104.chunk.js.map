{"version":3,"sources":["views/Bonds/components/ExchangeCard.tsx","views/Bonds/components/ExchangeStat.tsx","views/Bonds/Bond.tsx"],"names":["StyledCardTitle","styled","div","props","theme","colors","primary","spacing","StyledCardActions","StyledDesc","span","tertiary","StyledCardContentInner","ExchangeCard","action","fromToken","toToken","priceDesc","onExchange","disabled","disabledDescription","useState","requestedApproval","setRequestedApproval","balance","useTokenBalance","useApproveTreasury","onApprove","isApproved","handleApprove","useCallback","a","console","error","useModal","DepositModal","max","onConfirm","tokenName","onPresentDeposit","onClick","secondary","ExchangeStat","description","price","launchTime","Date","BOND_REDEEM_PRICE_BN","BigNumber","pow","multipliedBy","dividedBy","StyledHeader","BondHeader","as","size","mb","style","textAlign","StyledBond","StyledCardWrapper","Bond","account","useWallet","contract","useTreasury","bondBalance","QuoteToken","SBO","cashStat","useCashPriceInEstimatedTWAP","bondStat","useBondPriceInEstimatedTWAP","handleBuyBonds","amount","methods","buyBonds","send","from","handleRedeemBonds","redeemBonds","isBondRedeemable","useMemo","gt","isBondPurchasable","Number","now","getTime","Page","SDO","toFixed","Math","floor","Spacer","getDisplayBalance","eq","UnlockButton","mt","fullWidth","LaunchCountdown","deadline"],"mappings":"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","file":"static/js/17.cc550104.chunk.js","sourcesContent":["import React, { useState, useCallback } from 'react'\r\nimport { QuoteToken } from 'config/constants/types'\r\nimport { useApproveTreasury } from 'hooks/useApprove'\r\nimport useTokenBalance from 'hooks/useTokenBalance'\r\nimport styled from 'styled-components'\r\nimport { Button, Card, CardBody, useModal } from 'uikit'\r\nimport DepositModal from 'views/Farms/components/DepositModal'\r\n\r\ninterface ExchangeCardProps {\r\n  action: string\r\n  fromToken: QuoteToken\r\n  toToken: QuoteToken\r\n  priceDesc: string\r\n  onExchange: (amount: string) => void\r\n  disabled?: boolean\r\n  disabledDescription?: string\r\n}\r\n\r\nconst ExchangeCard: React.FC<ExchangeCardProps> = ({\r\n  action,\r\n  fromToken,\r\n  toToken,\r\n  priceDesc,\r\n  onExchange,\r\n  disabled = false,\r\n  disabledDescription,\r\n}) => {\r\n  const [requestedApproval, setRequestedApproval] = useState(false)\r\n  const balance = useTokenBalance(fromToken)\r\n  const { onApprove, isApproved } = useApproveTreasury(fromToken)\r\n\r\n  const handleApprove = useCallback(async () => {\r\n    try {\r\n      setRequestedApproval(true)\r\n      await onApprove()\r\n      setRequestedApproval(false)\r\n    } catch (e) {\r\n      console.error(e)\r\n    }\r\n  }, [onApprove])\r\n\r\n  const [onPresentDeposit] = useModal(<DepositModal max={balance} onConfirm={onExchange} tokenName={fromToken} />)\r\n\r\n  return (\r\n    <Card>\r\n      <CardBody>\r\n        <StyledCardContentInner>\r\n          <StyledCardTitle>{`${action} ${toToken}`}</StyledCardTitle>\r\n          <StyledDesc>{priceDesc}</StyledDesc>\r\n          <StyledCardActions>\r\n            {!isApproved && !disabled ? (\r\n              <Button disabled={requestedApproval} onClick={handleApprove}>\r\n                {`Approve ${fromToken}`}\r\n              </Button>\r\n            ) : (\r\n              <Button onClick={onPresentDeposit} disabled={disabled}>\r\n                {disabledDescription || action}\r\n              </Button>\r\n            )}\r\n          </StyledCardActions>\r\n        </StyledCardContentInner>\r\n      </CardBody>\r\n    </Card>\r\n  )\r\n}\r\n\r\nconst StyledCardTitle = styled.div`\r\n  align-items: center;\r\n  color: ${(props) => props.theme.colors.primary};\r\n  display: flex;\r\n  font-size: 20px;\r\n  font-weight: 700;\r\n  height: 64px;\r\n  justify-content: center;\r\n  margin-top: ${(props) => -props.theme.spacing[3]}px;\r\n`\r\n\r\nconst StyledCardActions = styled.div`\r\n  display: flex;\r\n  justify-content: center;\r\n  margin-top: ${(props) => props.theme.spacing[3]}px;\r\n  width: 100%;\r\n`\r\n\r\nconst StyledDesc = styled.span`\r\n  color: ${(props) => props.theme.colors.tertiary};\r\n`\r\n\r\nconst StyledCardContentInner = styled.div`\r\n  align-items: center;\r\n  display: flex;\r\n  flex: 1;\r\n  flex-direction: column;\r\n  justify-content: space-between;\r\n`\r\n\r\nexport default ExchangeCard\r\n","import { QuoteToken } from 'config/constants/types'\r\nimport React from 'react'\r\nimport styled from 'styled-components'\r\nimport { Card, CardBody } from 'uikit'\r\n\r\ninterface ExchangeStatProps {\r\n  tokenName: QuoteToken\r\n  description: string\r\n  price: string\r\n}\r\n\r\nconst ExchangeStat: React.FC<ExchangeStatProps> = ({ tokenName, description, price }) => {\r\n  return (\r\n    <Card>\r\n      <CardBody>\r\n        <StyledCardContentInner>\r\n          <StyledCardTitle>{`ðŸ’° ${tokenName} = $${price}`}</StyledCardTitle>\r\n          <StyledDesc>{description}</StyledDesc>\r\n        </StyledCardContentInner>\r\n      </CardBody>\r\n    </Card>\r\n  )\r\n}\r\n\r\nconst StyledCardTitle = styled.div`\r\n  color: ${(props) => props.theme.colors.primary};\r\n  font-size: 20px;\r\n  font-weight: 700;\r\n  margin-bottom: ${(props) => props.theme.spacing[2]}px;\r\n`\r\n\r\nconst StyledDesc = styled.span`\r\n  color: ${(props) => props.theme.colors.secondary};\r\n  text-align: center;\r\n`\r\n\r\nconst StyledCardContentInner = styled.div`\r\n  height: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex-direction: column;\r\n  padding: ${(props) => props.theme.spacing[2]}px;\r\n`\r\n\r\nexport default ExchangeStat\r\n","import React, { useCallback, useMemo } from 'react'\r\nimport styled from 'styled-components'\r\nimport { useWallet } from '@binance-chain/bsc-use-wallet'\r\nimport Page from 'components/layout/Page'\r\nimport BigNumber from 'bignumber.js'\r\nimport { Heading } from 'uikit'\r\nimport Spacer from 'components/Spacer'\r\nimport { useBondPriceInEstimatedTWAP, useCashPriceInEstimatedTWAP } from 'hooks/useExitBoardroom'\r\nimport { getDisplayBalance } from 'utils/formatBalance'\r\nimport { useTreasury } from 'hooks/useContract'\r\nimport UnlockButton from 'components/UnlockButton'\r\nimport LaunchCountdown from 'components/LaunchCountdown'\r\nimport useTokenBalance from 'hooks/useTokenBalance'\r\nimport { QuoteToken } from 'config/constants/types'\r\nimport ExchangeCard from './components/ExchangeCard'\r\nimport ExchangeStat from './components/ExchangeStat'\r\n\r\nconst launchTime = new Date(1616730082000)\r\n\r\nconst BOND_REDEEM_PRICE = 1.01\r\nconst BOND_REDEEM_PRICE_BN = new BigNumber(10).pow(18).multipliedBy(101).dividedBy(100)\r\n\r\nconst StyledHeader = styled.div`\r\n  justify-content: center;\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin-bottom: ${(props) => props.theme.spacing[5]}px;\r\n  width: 960px;\r\n\r\n  > * {\r\n    flex: 1;\r\n    height: 84px;\r\n    margin: 0 ${(props) => props.theme.spacing[2]}px;\r\n  }\r\n\r\n  @media (max-width: 768px) {\r\n    flex-direction: column;\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst BondHeader = () => (\r\n  <Heading as=\"h1\" size=\"lg\" mb=\"50px\" style={{ textAlign: 'center' }}>\r\n    ðŸ’° Bonds\r\n  </Heading>\r\n)\r\n\r\nconst Bond: React.FC = () => {\r\n  const { account } = useWallet()\r\n  const contract = useTreasury()\r\n  const bondBalance = useTokenBalance(QuoteToken.SBO)\r\n  const cashStat = useCashPriceInEstimatedTWAP()\r\n  const bondStat = useBondPriceInEstimatedTWAP()\r\n\r\n  const handleBuyBonds = useCallback(\r\n    async (amount: string) => {\r\n      await contract.methods.buyBonds(amount, cashStat).send({ from: account })\r\n    },\r\n    [cashStat, account, contract.methods],\r\n  )\r\n\r\n  const handleRedeemBonds = useCallback(\r\n    async (amount: string) => {\r\n      await contract.methods.redeemBonds(amount, bondStat).send({ from: account })\r\n    },\r\n    [bondStat, account, contract.methods],\r\n  )\r\n  const isBondRedeemable = useMemo(() => cashStat.gt(BOND_REDEEM_PRICE_BN), [cashStat])\r\n  const isBondPurchasable = useMemo(() => Number(bondStat) < 1.0, [bondStat])\r\n\r\n  const isLaunched = Date.now() >= launchTime.getTime()\r\n\r\n  if (!isLaunched) {\r\n    return (\r\n      <Page>\r\n        <BondHeader />\r\n        <LaunchCountdown deadline={launchTime} />\r\n      </Page>\r\n    )\r\n  }\r\n  return (\r\n    <Page>\r\n      <BondHeader />\r\n      {account ? (\r\n        <>\r\n          <StyledHeader>\r\n            <ExchangeStat\r\n              tokenName={QuoteToken.SDO}\r\n              description=\"Last-Hour TWAP Price\"\r\n              price={cashStat?.toFixed(3) || '-'}\r\n            />\r\n            <ExchangeStat\r\n              tokenName={QuoteToken.SBO}\r\n              description=\"Current Price\"\r\n              price={bondStat?.toFixed(3) || '-'}\r\n            />\r\n          </StyledHeader>\r\n          <StyledBond>\r\n            <StyledCardWrapper>\r\n              <ExchangeCard\r\n                action=\"Purchase\"\r\n                fromToken={QuoteToken.SDO}\r\n                toToken={QuoteToken.SBO}\r\n                priceDesc={\r\n                  !isBondPurchasable\r\n                    ? 'SDO is over $1'\r\n                    : `${Math.floor(100 / Number(bondStat) - 100)}% return when SDO > $1`\r\n                }\r\n                onExchange={handleBuyBonds}\r\n                disabled={!bondStat || isBondRedeemable}\r\n              />\r\n            </StyledCardWrapper>\r\n            <Spacer />\r\n            <StyledCardWrapper>\r\n              <ExchangeCard\r\n                action=\"Redeem\"\r\n                fromToken={QuoteToken.SBO}\r\n                toToken={QuoteToken.SDO}\r\n                priceDesc={`${getDisplayBalance(bondBalance)} SDO Available`}\r\n                onExchange={handleRedeemBonds}\r\n                disabled={!bondStat || bondBalance.eq(0) || !isBondRedeemable}\r\n                disabledDescription={!isBondRedeemable ? `Enabled when SDO > $${BOND_REDEEM_PRICE}` : null}\r\n              />\r\n            </StyledCardWrapper>\r\n          </StyledBond>\r\n        </>\r\n      ) : (\r\n        <UnlockButton mt=\"8px\" fullWidth />\r\n      )}\r\n    </Page>\r\n  )\r\n}\r\n\r\nconst StyledBond = styled.div`\r\n  display: flex;\r\n  width: 960px;\r\n  @media (max-width: 768px) {\r\n    width: 100%;\r\n    flex-flow: column nowrap;\r\n    align-items: center;\r\n  }\r\n`\r\n\r\nconst StyledCardWrapper = styled.div`\r\n  display: flex;\r\n  flex: 1;\r\n  flex-direction: column;\r\n  @media (max-width: 768px) {\r\n    width: 80%;\r\n  }\r\n`\r\n\r\nexport default Bond\r\n"],"sourceRoot":""}